// Append new message
message = ('<%= j render(partial: "messages/message", locals: { message: @message } ).html_safe %>')
$(".messages-container").append(message)

// Resize the input text area to default
$('textarea').css('height', "42px")

$('.progress_bar_progress_thin').remove()
$('.navbar-progress').append("<span class='progress_bar_progress_thin'>")
$('.progress_bar_progress_thin').css("width", "100%")
$('.navbar-progress').hide()
$('.progress_bar_progress_thin').css("width", "0%")



$('#new_message').find("button[type='submit']").prop('disabled', false)
mixpanel.track("Nouveau message", {
    "user_id": <%= @message.user.id %>,
    "Immeuble": <%= @message.user.building_id %>
})

messageTop = $('.msg-container').last().offset().top
$('html, .scroll-container').animate({scrollTop:99999999}, 'slow');
$('#message_body').val("")

// publisher = client.publish('/messages', {
//   message: '<%= j render @message %>'
// });

// publisher.callback(function() {
//   $('#new_message').find("button[type='submit']").prop('disabled', false)
//   mixpanel.track("Nouveau message", {
//       "user_id": <%= @message.user.id %>,
//       "Immeuble": <%= @message.user.building_id %>
//   });


